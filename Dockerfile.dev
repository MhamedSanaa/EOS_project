# FROM postgres:14.7
# COPY ./ecomm.sql /docker-entrypoint-initdb.d/ecomm.sql
# COPY ./install-pgcrypto.sh /docker-entrypoint-initdb.d/
# RUN chown -R postgres:postgres /docker-entrypoint-initdb.d/
FROM postgres:14.7

# Set the working directory
WORKDIR /docker-entrypoint-initdb.d

# Copy initialization scripts
COPY ./ecomm.sql /docker-entrypoint-initdb.d/ecomm.sql
COPY ./install-pgcrypto.sh /docker-entrypoint-initdb.d/install-pgcrypto.sh

# Ensure scripts are executable
RUN chmod +x /docker-entrypoint-initdb.d/install-pgcrypto.sh

# Set ownership to the postgres user
RUN chown -R postgres:postgres /docker-entrypoint-initdb.d/

# Environment variable to set the extension script
ENV POSTGRES_EXTENSION_SCRIPT /docker-entrypoint-initdb.d/install-pgcrypto.sh

# This runs the parent entrypoint script (from postgres image)
CMD ["docker-entrypoint.sh", "postgres"]